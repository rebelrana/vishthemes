{% comment %}
Spacein main product section
Provides left image slider, right product info, variant handling,
quantity buttons, add-to-cart, and related products slider.
{% endcomment %}

{{ 'spacein-product.css' | asset_url | stylesheet_tag }}

<section class="spacein-product-section">
	<div class="spacein-product">
		<div class="spacein-left">
			<div class="spacein-slider" data-current="0">
				{% for img in product.images %}
					<div class="spacein-slide" data-index="{{ forloop.index0 }}" data-variant-ids="{{ img.variant_ids | json }}">
						<img src="{{ img | img_url: '1024x1024' }}" alt="{{ img.alt | escape }}">
					</div>
				{% endfor %}
			</div>
			<div class="spacein-thumbs">
				{% for img in product.images %}
					<button type="button" class="spacein-thumb" data-index="{{ forloop.index0 }}">
						<img src="{{ img | img_url: '160x160' }}" alt="">
					</button>
				{% endfor %}
			</div>
		</div>

		<div class="spacein-right">
			<h1 class="spacein-title">{{ product.title }}</h1>
			<div class="spacein-price" data-price>{{ product.price | money }}</div>
			<div class="spacein-desc">{{ product.description | strip_html | truncate: 400 }}</div>

			<form id="spacein-add-to-cart" class="spacein-form" action="/cart/add" method="post">
				<input type="hidden" name="id" id="spacein-variant-id" value="{{ product.variants.first.id }}">

				<div class="spacein-options">
					{% for option in product.options_with_values %}
						<label class="spacein-option-label">{{ option.name }}</label>
						<select class="spacein-option" data-option-index="{{ forloop.index0 }}">
							{% for value in option.values %}
								<option value="{{ value }}">{{ value }}</option>
							{% endfor %}
						</select>
					{% endfor %}
				</div>

				<div class="spacein-quantity">
					<button type="button" class="qty-btn" data-action="decrease">âˆ’</button>
					<input type="number" name="quantity" id="spacein-quantity" value="1" min="1">
					<button type="button" class="qty-btn" data-action="increase">+</button>
				</div>

				<button type="submit" class="spacein-add-btn">Add to cart</button>
			</form>
		</div>
	</div>

	<div class="spacein-related">
		<h3>Related products</h3>
		<div class="spacein-related-track">
			{% assign related_collection = product.collections.first %}
			{% if related_collection %}
				{% for p in related_collection.products limit:8 %}
					{% if p.id != product.id %}
						<div class="spacein-related-card">
							<a href="{{ p.url }}">
								<img src="{{ p.featured_image | img_url: '400x400' }}" alt="{{ p.title }}">
								<div class="rp-title">{{ p.title }}</div>
								<div class="rp-price">{{ p.price | money }}</div>
							</a>
						</div>
					{% endif %}
				{% endfor %}
			{% endif %}
		</div>
	</div>

</section>

{% comment %} expose product JSON for JS logic {% endcomment %}
<script>window.spaceinProduct = {{ product | json }};</script>
{{ 'spacein-product.js' | asset_url | script_tag }}
